<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <title></title>
</head>
<style type="text/css">
body {
    background-color: #ffffff;
}

p {
    text-align: center;
    font-weight: bold;
    font-size: 24px;
}

.fotes {
    font-size: 18px;
    font-weight: 600;
}
</style>

<body id="showpdf">
    <p>2018 年下学期</p>
    <p>青岛市黄岛区机关第一幼儿园</p>
    <p>南城区分园学期总结</p>
    <div class="fotes" style="margin-top: 20px;margin-bottom: 20px;width: 90%;margin: 0 auto;">深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方</div>
    <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
    <div style="text-align: center;">
        <img src="http://library.magicbaba.com/img/pc/logo2017.png" style="width: 800px;">
        </div>
        <div id="main" style="height:400px;height: 400px;"></div>
        <div class="fotes" style="margin-top: 20px;margin-bottom: 20px;width: 90%;margin: 0 auto;">深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方深刻鉴定会会计师大后方</div>
        <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
            <tr>
                <td>名字</td>
                <td>性别</td>
                <td>看看</td>
                <td>问问</td>
            </tr>
            <tr>
                <td>0分</td>
                <td>2条</td>
                <td>0</td>
                <td>1</td>
            </tr>
            <tr>
                <td>0分</td>
                <td>2条</td>
                <td>0</td>
                <td>1</td>
            </tr>
        </table>
        <div style="text-align: center;">
            <img src="http://library.magicbaba.com/img/pc/logo2017.png" style="width: 800px;">
        </div>
        <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
    <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
    <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
    <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
            <div id="mains" style="height:400px;height: 400px;"></div>
            <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
    <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
    <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
    <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
    <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
    <table class="table table-bordered" style="width: 90%;margin:0 auto;margin-top: 20px;margin-bottom: 20px;">
        <tr>
            <td>名字</td>
            <td>性别</td>
            <td>看看</td>
            <td>问问</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>0分</td>
            <td>2条</td>
            <td>0</td>
            <td>1</td>
        </tr>
    </table>
            <button id="downloadpdf">download pdf</button>
</body>
<script src="js/html2canvas.js" type="text/javascript" charset="utf-8"></script>
<script src="js/jspdf.js" type="text/javascript" charset="utf-8"></script>
<!-- <script src="js/autotable.js" type="text/javascript" charset="utf-8"></script> -->
<script src="js/echarts.min.js" type="text/javascript" charset="utf-8"></script>
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
<script type="text/javascript">
var myChart = echarts.init(document.getElementById('main'));
var myChart2 = echarts.init(document.getElementById('mains'));


option = {
    title: {
        text: '天气情况统计',
        subtext: '虚构数据',
        left: 'center'
    },
    tooltip: {
        trigger: 'item',
        formatter: "{a} <br/>{b} : {c} ({d}%)"
    },
    legend: {
        // orient: 'vertical',
        // top: 'middle',
        bottom: 10,
        left: 'center',
        data: ['西凉', '益州', '兖州', '荆州', '幽州']
    },
    series: [{
        type: 'pie',
        radius: '65%',
        center: ['50%', '50%'],
        selectedMode: 'single',
        data: [{
                value: 1548,
                name: '幽州',

            },
            { value: 535, name: '荆州' },
            { value: 510, name: '兖州' },
            { value: 634, name: '益州' },
            { value: 735, name: '西凉' }
        ],
        itemStyle: {
            emphasis: {
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowColor: 'rgba(0, 0, 0, 0.5)'
            }
        }
    }]
};

myChart.setOption(option);
myChart2.setOption(option);
</script>
<script type="text/javascript">
$(function() {
     //导出pdf分页上下不留空白
    // function convertCanvasToImage() {
    //     html2canvas(document.getElementById("showpdf"), {
    //         onrendered: function(canvas) {
    //             var contentWidth = canvas.width;
    //             var contentHeight = canvas.height;

    //             //一页pdf显示html页面生成的canvas高度;
    //             var pageHeight = contentWidth / 592.28 * 841.89;
    //             //未生成pdf的html页面高度
    //             var leftHeight = contentHeight;
    //             //页面偏移
    //             var position = 0;
    //             //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高
    //             var imgWidth = 595.28;
    //             var imgHeight = 592.28 / contentWidth * contentHeight;

    //             var pageData = canvas.toDataURL('image/jpeg', 1.0);
    //             console.log(jsPDF);
    //             var pdf = new jsPDF('', 'pt', 'a4');

    //             //有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)
    //             //当内容未超过pdf一页显示的范围，无需分页
    //             if (leftHeight < pageHeight) {
    //                 pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight);
    //             } else {
    //                 while (leftHeight > 0) {
    //                     pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
    //                     leftHeight -= pageHeight;
    //                     position -= 841.89;
    //                     //避免添加空白页
    //                     if (leftHeight > 0) {
    //                         pdf.addPage();
    //                     }
    //                 }
    //             }

    //             pdf.save('content.pdf');
    //         }
    //     })
    // }


    
    //导出pdf分页上下有空白
    function convertCanvasToImage() {
        var element = document.getElementById("showpdf");
        html2canvas(document.getElementById("showpdf"), {
            onrendered: function(canvas) {
            var pdf = new jsPDF('p', 'mm', 'a4');    //A4纸，纵向
            var ctx = canvas.getContext('2d'),
                a4w = 190, a4h = 277,    //A4大小，210mm x 297mm，四边各保留10mm的边距，显示区域190x277
                imgHeight = Math.floor(a4h * canvas.width / a4w),    //按A4显示比例换算一页图像的像素高度
                renderedHeight = 0;

            while(renderedHeight < canvas.height) {
                var page = document.createElement("canvas");
                page.width = canvas.width;
                page.height = Math.min(imgHeight, canvas.height - renderedHeight);//可能内容不足一页

                //用getImageData剪裁指定区域，并画到前面创建的canvas对象中
                page.getContext('2d').putImageData(ctx.getImageData(0, renderedHeight, canvas.width, Math.min(imgHeight, canvas.height - renderedHeight)), 0, 0);
                pdf.addImage(page.toDataURL('image/jpeg', 1.0), 'JPEG', 10, 10, a4w, Math.min(a4h, a4w * page.height / page.width));    //添加图像到页面，保留10mm边距
                
                renderedHeight += imgHeight;
                if(renderedHeight < canvas.height)
                    pdf.addPage();//如果后面还有内容，添加一个空页
                delete page;
            }
            pdf.save('content.pdf');
         }
        });
    }

    $("#downloadpdf").unbind("click").on("click", function() {

        convertCanvasToImage()

    })

    

   


})
</script>

</html>